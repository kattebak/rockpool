# Apply convention over configuration for resource naming

## Status

_accepted_

## Context

In a multi-account, multi-stage AWS architecture, resources need consistent, predictable names. There are two approaches to sharing resource identifiers between stacks and stages:

### Option 1: SSM Parameters

Store resource names/ARNs in SSM Parameter Store and look them up at deployment time.

Pros:

- Flexible, can change without redeploying consumers
- Explicit dependency tracking

Cons:

- Requires cross-account SSM access configuration
- Adds latency to CDK synthesis (SSM lookups)
- More infrastructure to manage
- Values cached in `cdk.context.json` can become stale

### Option 2: Naming conventions

Define deterministic naming functions that generate resource names from stage configuration.

Pros:

- No external lookups required
- Faster CDK synthesis
- No cross-account permission complexity
- Names are predictable and documentable

Cons:

- Changing conventions requires coordinated deployments
- Less flexible for exceptional cases

## Decision

- Use naming convention functions in `src/lib/format.ts` for all predictable resource names
- Reserve SSM Parameters for values that cannot be derived (e.g., Cognito User Pool IDs, CloudFront distribution IDs)
- Naming functions follow the pattern: `format{ResourceType}Name({ stageName, ...params })`

Example naming functions:

```typescript
export const formatTableName = ({ stageName }: { stageName: string }) =>
  `${stageName}-app-primary`;

export const formatFunctionName = ({ stageName }: { stageName: string }) =>
  `${stageName}-app-backend`;

export const formatBucketName = ({ stageName }: { stageName: string }) =>
  `${stageName}-app-frontend`;

export const formatDistributionComment = ({ stageName }: { stageName: string }) =>
  `${stageName}-app-frontend`;
```

## Consequences

- Faster CDK synthesis without SSM lookups
- Simpler cross-account deployments
- Resource names are self-documenting and predictable
- Changing naming conventions requires careful coordination
- SSM Parameters still needed for non-deterministic values (IDs generated by AWS)
